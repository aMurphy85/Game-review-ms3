{% extends "base.html" %}
{% block content %}
        
<div class="row">
    <div class="col s12 m10 l8 offset-l2 offset-m1" id="card">
        <div class="card game-card grey darken-4">
            <div class="card-image">
                <img id="card-image" src="{{ game.game_url }}">
            </div>

            <div class="card-content white-text">
                <div class="row ">                    
                    <div class="col s10 m10 l10 offset-s1 offset-m1 offset-l1">
                        <h3>{{ game.game_title }}</h3>
                    </div>
                </div>

                <div class="row game-info">
                    <div class="col s10 m10 l10 offset-s1 offset-m1 offset-l1">
                        <h5 class="h5">Game play description:</h5>
                        <p>
                            {{ game.game_description }}
                        </p>
                    </div>
                </div>

                <div class="game-info">
                    <div class="row">
                        <div class="col s10 m6 l6 offset-s1 offset-m1 offset-l1 green lighten-2 light-blue lighten-3">
                            <i class="fas fa-tools white-text"></i>
                            <p>
                                <strong>Developers:</strong> {{ game.game_developers }}
                            </p>
                        </div>
                        <div class="col s10 m4 l4 offset-s1 grey darken-1">
                            <i class="fas fa-calendar-alt white-text"></i>
                            <p>
                                <strong>Released: {{ game.game_released }}</strong>
                            </p>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col s10 m4 l4 offset-s1 offset-m1 offset-l1 deep-purple lighten-3">
                            <i class="fas fa-users white-text"></i>
                            <p>
                                <strong>{{ game.num_of_players }}</strong>
                            </p>
                        </div>
                        <div class="col s10 m6 l6 offset-s1 red darken-2">
                            <i class="fas fa-theater-masks white-text"></i>
                            <p>
                                <strong>Genre: {{ game.game_genre }}</strong>
                            </p>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col s10 m10 l10 offset-s1 offset-m1 offset-l1 light-blue lighten-3">
                            <i class="fas fa-gamepad white-text"></i>
                            <p>
                                <strong>Platforms:</strong> {{ game.game_platforms }}
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Modal1 trigger -->
                <div class="row">
                    <div class="col s12 center-align">
                        <a class="waves-effect waves-light btn-small modal-trigger red darken-4" href="#modal1" id="btn">
                            Leave a review <i class="fas fa-pen"></i>
                        </a>
                    </div>
                </div>
                <!-- Modal1 Structure -->
                <div id="modal1" class="modal col m10 l8 grey darken-4">
                    <div class="modal-content grey darken-4" id="card-panel">

                        <div class="container center-align">
                            <h4 class="white-text">Add review</h4>
                        </div>

                        <div class="col s12 m8 l6 offset-m2 offset-l3 card-image" id="modal-img">
                            <img src="{{ game.game_url }}">
                        </div>

                        <!-- review input form -->
                        <form  method="POST" action="{{ url_for('add_review') }}">

                            <!-- review date picker -->
                            <div class="row">
                                <div class="col s4 offset-s4 center-align">
                                    <input type="text" class="datepicker white-text center-align" id="date" name="date" required>
                                    <label class="white-text" for="date">
                                        <h5 id="fa-calender"><i class="far fa-calendar-alt"></i></h5>
                                        Re-enter date of review
                                    </label>
                                </div>
                            </div>

                            <!-- review text area -->
                            <div class="row">
                                <div class="col s12 review-header">
                                    <h5 class="white-text center-align"><strong>Review</strong></h5>
                                </div>
                            </div>

                            <div class="row">
                                <input type="hidden" value="{{ game.game_title }}" name="game_title" />
                                <div class="input-field col s10 m8 l8 offset-s1 offset-m2 offset-l2">                                            
                                    <textarea id="user_review" name="user_review" minlength="5"
                                        maxlength="200" class="materialize-textarea white-text validate" required></textarea>
                                    <label class="white-text" for="user_review">
                                        <i class="fas fa-pencil-alt white-text"></i>
                                        Leave your review here...
                                    </label>
                                </div>
                            </div>                              

                            <!-- star rating code from 
                                https://gist.github.com/blairanderson/7f9d1c08345c6573e09edaa1f7316fa1-->
                            <div class="row">
                                <div class="col s12 center-align">
                                    <h5 class="white-text"><strong>Rating</strong></h5>
                                </div>
                            </div>

                            <div class="row center-align">
                                
                                <div class="rating center-align">                                 
                                    <!-- 5 star rating -->
                                    <input type="radio" id="radio-btn-1" name="star_rating" value="5 stars" required>
                                    <label class="star-label" for="radio-btn-1">&#9733;</label>
                                    
                                    <input type="radio" id="radio-btn-2" name="star_rating" value="4 stars" required>
                                    <label class="star-label" for="radio-btn-2">&#9733;</label>
                                    
                                    <input type="radio" id="radio-btn-3" name="star_rating" value="3 stars" required>
                                    <label class="star-label" for="radio-btn-3">&#9733;</label>
                                    
                                    <input type="radio" id="radio-btn-4" name="star_rating" value="2 stars" required>
                                    <label class="star-label" for="radio-btn-4">&#9733;</label>
                                    
                                    <input type="radio" id="radio-btn-5" name="star_rating" value="1 star" required>
                                    <label class="star-label" for="radio-btn-5">&#9733;</label>
                                </div>
                                                     
                            </div>
                            <div class="row">
                                <div class="col s12 center-align">
                                    <p>(select a star amount)</p>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col s12 center-align">
                                    <button class="btn waves-effect red darken-3" type="submit" id="submit-btn">
                                        Submit Review
                                        <i class="fas fa-paper-plane right"></i>
                                    </button>
                                </div>
                            </div>
                        </form>

                        <div class="modal-footer grey darken-4">
                            <a href="#!" class="modal-close waves-effect waves-light btn-small red darken-4">Close</a>
                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- reviews -->
<div class="row">
    <div class="col s12 m10 l8 offset-l2 offset-m1">
        <h4 class="header white-text">Reviews</h4>
    </div>
</div>

<div class="row">
    <div class="col s12 m10 l8 offset-l2 offset-m1" id="card">
        <div class="card review-card grey darken-4">
            {% for review in reviews %}
                <div class="card-content">
                    <div class="row" id="card-content">
                        <div class="col s4 m2 l2 offset-m1 offset-l1">
                            <h5 class="review-name spacer white-text">{{ review.created_by }}</h5>                            
                            <p class="spacer white-text"><small>Posted:</small></p>
                            <p class="spacer white-text"><strong>{{ review.date }}</strong></p>
                        </div>
                        <div class="col s8 m8 l8" id="review-card">
                            <p class="spacer white-text"><small>Rated this game:</small></p>
                            <p class="spacer white-text"><i class="review-fas fas fa-star"></i>
                                <strong>{{ review.star_rating }}</strong>
                                <p class="spacer white-text">
                                    {{ review.user_review }}
                                </p>
                            </p>
                        </div>
                    </div>
                </div>

                <!-- edit review modal -->
                <!-- Modal2 Trigger -->
                <div class="row">
                    <div class="col s12 center-align">
                        <a class="waves-effect waves-light btn-small modal-trigger red darken-4" href="#modal2">
                            edit <i class="fas fa-pen"></i>
                        </a>
                    </div>
                </div>

                <!-- Modal2 Structure -->
                <div id="modal2" class="modal col m10 l8 grey darken-4">
                    <div class="modal-content grey darken-4" id="card-panel">
                        <div class="container center-align">
                            <h4 class="white-text">Edit review</h4>
                        </div>

                        <div class="col s12 m8 l6 offset-m2 offset-l3 card-image" id="modal-img">
                            <img src="{{ game.game_url }}">
                        </div>

                        <!-- review input form -->
                        <form  method="POST" action="{{ url_for('edit_review', review_id=review._id) }}">

                            <!-- review date picker -->
                            <div class="row">
                                <div class="col s4 offset-s4 center-align">
                                    <input type="text" class="datepicker white-text center-align" id="date" 
                                        name="date" required>
                                    <label class="white-text" for="date">
                                        <h5 id="fa-calender"><i class="far fa-calendar-alt"></i></h5>
                                        Re-enter date of review
                                    </label>
                                </div>
                            </div>

                            <!-- review text area -->
                            <div class="row">
                                <div class="col s12 review-header">
                                    <h5 class="white-text center-align"><strong>Review</strong></h5>
                                </div>
                            </div>

                            <div class="row">
                                <input type="hidden" value="{{ game.game_title }}" name="game_title" />
                                <div class="input-field col s10 m8 l8 offset-s1 offset-m2 offset-l2">                                            
                                    <input id="user_review" name="user_review"  type="text" minlength="5" maxlength="200"
                                        value="{{ review.user_review }}" class="validate white-text" required>
                                    <label for="user_review"><i class="fas fa-pencil-alt white-text"></i>
                                        Leave your review here...
                                    </label>
                                </div>
                            </div>                              

                            <!-- star rating code from 
                                https://gist.github.com/blairanderson/7f9d1c08345c6573e09edaa1f7316fa1-->
                            <div class="row">
                                <div class="col s12 center-align">
                                    <h5 class="white-text"><strong>Rating</strong></h5>
                                </div>
                            </div>

                            <div class="row center-align">
                                
                                <div class="rating center-align">                                 
                                    <!-- 5 star rating -->
                                    <input type="radio" id="radio-btn-6" name="star_rating" value="5 stars" required>
                                    <label class="star-label" for="radio-btn-6">&#9733;</label>
                                    
                                    <input type="radio" id="radio-btn-7" name="star_rating" value="4 stars" required>
                                    <label class="star-label" for="radio-btn-7">&#9733;</label>
                                    
                                    <input type="radio" id="radio-btn-8" name="star_rating" value="3 stars" required>
                                    <label class="star-label" for="radio-btn-8">&#9733;</label>
                                    
                                    <input type="radio" id="radio-btn-9" name="star_rating" value="2 stars" required>
                                    <label class="star-label" for="radio-btn-9">&#9733;</label>
                                    
                                    <input type="radio" id="radio-btn-10" name="star_rating" value="1 star" required>
                                    <label class="star-label" for="radio-btn-10">&#9733;</label>
                                </div>
                                                     
                            </div>
                            <div class="row">
                                <div class="col s12 center-align">
                                    <p class="white-text">(select a star amount)</p>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col s12 center-align">
                                    <a href="{{ url_for('get_games') }}" class="modal-close btn waves-effect waves-light btn-small red darken-3" 
                                        type="submit" id="btn">
                                        cancel
                                        <i class="fas fa-times-circle right"></i>
                                    </a>
                                    <button class="btn waves-effect waves-light btn-small red darken-3" type="submit" id="btn">
                                        Update Review
                                        <i class="fas fa-edit right"></i>
                                    </button>
                                </div>
                            </div>
                        </form>

                        <div class="modal-footer grey darken-4">
                            <a href="#!" class="modal-close waves-effect waves-light btn-small red darken-4">Close</a>
                        </div>

                    </div>
                </div>

                {% else %}
                <div class="row">
                    <div class="col s12 center-align">
                        <h4 class="white-text">No reviews submitted</h4>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>

<div class="row center-align">
    <div class="col s12">
        <a class="btn waves-effect red darken-3 back-btn"  href="{{ url_for('get_games') }}" type="submit" name="action">
            <i class="fas fa-backward white-text left"></i> Back        
        </a>
    </div>
</div>

{% endblock %}
